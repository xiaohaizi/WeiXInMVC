<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta charset="utf-8">
    <title>微信公众平台</title>
    <script type="text/javascript">window._points=[+new Date];// 初始测速点</script>
    <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/promotion/res/zh_CN/htmledition/comm_htmledition/style/base/layout_head.css" />
    <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/promotion/res/zh_CN/htmledition/comm_htmledition/style/base/base.css" />
    <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/promotion/res/zh_CN/htmledition/comm_htmledition/style/base/lib.css" />
    <style type="text/css">
        .pop_ad_helper .popover_arrow {
            left: 280px;
            margin-top: -8px;
        }
    </style>
</head>
<body class="zh_CN">
    <div id="body" class="body container_box ">

        <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/style/page/adSystem/adSystem_common.css" />
        <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/style/page/adSystem/ad_sell.css" />
        <link rel="stylesheet" type="text/css" href="//res.wx.qq.com/mpres/htmledition/style/widget/button_group.css" />
        <link rel="stylesheet" type="text/css" href="//wximg.qq.com/tmt/mpa/beta/css/style-moment-edit-template.5b7682da.css" />
        <script type="text/javascript">window._points[1]=+new Date;// css加载完成</script>


        <div class="main_hd">
            <h2>流量主</h2>
            <div id="topTab"></div>
            <p class="extra_info mini_tips icon_after">
                <label class="mini_tips icon_after" id="js_ad_helper" data-flag="host">帮助<i class="icon_msg_mini ask"></i></label>
            </p>
        </div>
        <!-- <div class="highlight_box">
                <ul class="links">
                    <li class="links_item no_extra selected"><a href="javascript:;">报表统计</a></li>
                    <li class="links_item"><a id="host_push_link" href="//mp.weixin.qq.com/cgi-bin/frame?t=ad_system/common_frame&t1=publisher/host_push" target="_top">数据推送</a></li>
                </ul>
        </div> -->

        <ul class="mod-frame__sub-tab" style="display: block;">
            <li class="mod-frame__sub-tab-item mod-frame__sub-tab-item_current"><a href="javascript:;">报表统计</a></li>
            <li class="mod-frame__sub-tab-item"><a id="host_push_link" href="//mp.weixin.qq.com/cgi-bin/frame?t=ad_system/common_frame&t1=publisher/host_push" target="_top">数据推送</a></li>
        </ul>

        <div class="mod-highlight-box ui-bfc ui-mt-20" style="display:none;" id="freetrade_open"><div><div class="mod-highlight-box__button ui-fl-r"><a role="button" class="button button_primary" id="open_freetrade_btn">立即开启</a></div><div class="mod-highlight-box__content ui-bfc__content" style="padding-left: 0px;"><h4>互选广告</h4><p class="ui-c-gray">开通互选广告，自由选择你想要的广告合作，查看<a href="http://wximg.qq.com/wxp/assets/data/huxuan/OA_MutualSelectedAds_SupplierManual_20170307.pdf" target="_blank"> 互选广告合作指引</a></p></div></div></div>

        <div class="wrp_select_box">
            <div class="select_box">


                <!-- <div class="dropdown_menu" id="posDr"></div> -->

                <div class="button_group  cascade_dropdown first">
                    <a class="btn btn_default jsDay selected" data-start="-6" data-end="0" href="javascript:;">最近7日</a><a class="btn btn_default jsDay" data-start="-29" data-end="0" href="javascript:;">最近30日</a><div class="btn_group_item td_data_container" id="dateRange"></div>
                </div>
            </div>
        </div>
        <div class="main_bd page_host_report">
            <!--<div class="wrp_select_box">
                    <div class="select_box">
                       <div class="frm_control_group">
                           <label for="" class="frm_label">计费方式：</label>
                           <div class="frm_controls">
                               <a href="#" class="btn select_btn selected">按曝光计费</a>
                               <a href="#" class="btn select_btn">按曝光计费</a>
                           </div>
                       </div>
                    </div>

                    <div class="select_box last">
                       <div class="frm_control_group">
                           <label for="" class="frm_label">商品类型：</label>
                           <div class="frm_controls">
                               <a href="#" class="btn select_btn selected">全部</a>
                               <a href="#" class="btn select_btn">品牌活动</a>
                               <a href="#" class="btn select_btn">ios应用</a>
                               <a href="#" class="btn select_btn">Android应用</a>
                               <a href="#" class="btn select_btn">公众号</a>
                           </div>
                       </div>
                    </div>
            </div>-->

            <div class="wrp_sub_ads_data pt_interval">
                <span>当日数据仅供参考，请以前一天数据为准。</span>
            </div>

            <div class="key_info_box">
                <div class="inner">
                    <div class="info_hd rel">
                        <h4>关键指标</h4>
                        <!--<i class="icon_msg_mini ask abs" id="js_target"></i>
                        <div class="pop_keywords" style="display:none">
                            <h5>商品指标量</h5>
                            <p>XXXX</p>
                            <h5>成本</h5>
                            <p>XXXX</p>
                            <h5>平均价格</h5>
                            <p>XXXX</p>
                        </div>-->
                    </div>
                    <div class="info_bd" id="table_0">
                        <div class="basic_data_wrapper">
                            <ul class="basic_data_list sizeof_col4">
                                <li class="basic_data_item first_data-item">
                                    <p class="basic_data_key">曝光量</p>
                                    <p class="basic_data_val totalVal jsTotal" data-type="show"></p>
                                </li>
                                <li class="basic_data_item">
                                    <p class="basic_data_key">点击量</p>
                                    <p class="basic_data_val totalVal jsTotal" data-type="click"></p>
                                </li>
                                <li class="basic_data_item">
                                    <p class="basic_data_key">点击率</p>
                                    <p class="basic_data_val totalVal jsTotal" data-type="click_per"></p>
                                </li>
                                <!--<li class="basic_data_item sizeof_col5 dn">
                                   <p class="basic_data_key">关注量</p>
                                   <p class="basic_data_val totalVal jsTotal" data-type="care"></p>
                                </li>-->
                                <li class="basic_data_item last">
                                    <p class="basic_data_key">总收入(元)<span class="fee_unit"> </span></p>
                                    <p class="basic_data_val totalVal jsTotal" data-type="total">¥</p>
                                </li>
                            </ul>
                        </div>
                        <p class="no_data jsTotalNo">暂无数据</p>
                    </div>
                </div>
            </div>

            <div class="key_info_box wrp_keywords_trend">
                <div class="inner">
                    <div class="info_hd with_tabs">
                        <h4><span>关键指标趋势图</span></h4>
                        <div class="query_opr">
                            <div class="button_group in_info_box">
                                <div class="dropdown_menu btn_group_item " id="posTypeSelect"></div>
                                <div class="dropdown_menu btn_group_item " id="chartSelect"></div>
                            </div>
                        </div>
                    </div>
                    <div class="info_bd">
                        <div class="chart_info" id="chartContain"></div>
                    </div>
                </div>
            </div>

            <!-- <div class="key_info_box wrp_keywords_trend">
                 <div class="inner">
                     <div class="info_hd with_tabs">
                        <div class="dropdown_menu tab_dropdown_menu" id=""></div>
                     </div>
                     <div class="info_bd">
                        <div class="chart_info" id=""></div>
                     </div>
                 </div>
            </div> -->

            <div class="key_info_box wrp_keywords_chart dn" id="table_3">
                <div class="inner">
                    <div class="info_hd">
                        <h4 class="block">
                            <span class="fl">互选广告指标明细</span>
                            <a href="javascript:;" pos_type="3" id='downBt_3' class="hd_download fl downBt">下载</a>
                        </h4>

                    </div>
                    <div class="wrp_tab_keywords_chart info_bd">
                        <table class="tab_keywords_chart" cellspacing="0" cellspadding="0">
                            <thead>
                                <tr>
                                    <th colspan="2">时间</th>
                                    <th>曝光量</th>
                                    <th>点击量</th>
                                    <th>点击率</th>
                                    <th class="dn">关注量</th>
                                    <th>总收入(元)</th>
                                </tr>
                            </thead>
                            <tbody id="detail_3"></tbody>
                        </table>
                        <p class="no_data jsTotalNo">暂无数据</p>
                    </div>
                </div>
                <div class="turn_page pos_right pr_none" id="pageBar_3"> </div>
            </div>
            <div class="key_info_box wrp_keywords_chart" id="table_1">
                <div class="inner">
                    <div class="info_hd">
                        <h4 class="block">
                            <span class="fl">底部广告指标明细</span>
                            <a href="javascript:;" pos_type='1' id='downBt_1' class="hd_download fl downBt">下载</a>
                        </h4>

                    </div>
                    <div class="wrp_tab_keywords_chart info_bd">
                        <table class="tab_keywords_chart" cellspacing="0" cellspadding="0">
                            <thead>
                                <tr>
                                    <th colspan="2">时间</th>
                                    <th>曝光量</th>
                                    <th>点击量</th>
                                    <th>点击率</th>
                                    <th class="dn">关注量</th>
                                    <th>总收入(元)</th>
                                </tr>
                            </thead>
                            <tbody id="detail_1"></tbody>
                        </table>
                        <p class="no_data jsTotalNo">暂无数据</p>
                    </div>
                </div>
                <div class="turn_page pos_right pr_none" id="pageBar_1"> </div>
            </div>
        </div>

        <script type="text/html" id="tpl">
            {each data as o index}
            <tr>
                <td colspan="2">{o.time} </td>
                <td>{o.show}</td>
                <td>{o.click}</td>
                <td>{o.click_per}%</td>
                <td>{o.total}</td>
            </tr>
            {/each}
        </script>

        <script type="text/html" id="freetradePop">
            <link rel="stylesheet" type="text/css" href="//wximg.qq.com/tmt/mpa/dist/css/style-moment-edit-template.80ab8f92.css" />
            <div class='ui-bfc'>
                <div class='ui-bfc__left' style="width: 256px; margin-left: 55px; margin-right: 125px;">
                    <img src='//wximg.qq.com/wxp/assets/image/huxuan.png' width='256px' height='418px' alt='' />
                </div>
                <div class='ui-bfc__left' style="width: 325px; margin-top: 60px">
                    <div class='ui-mb-15 ui-fz-18'>
                        公众号互选广告
                    </div>
                    <div>
                        微信公众号互选广告，是广告主和流量主通过微信广告平台双向互选、自由达成广告合作的一种投放模式，广告创意呈现在公众号文章内。
                    </div>

                    <div style="margin-top: 120px">
                        <label class="label">
                            <i class="label__checkbox-icon"></i>
                            <span class="label__content">我已阅读 <a className='link' target='_blank' href='//wximg.qq.com/wxp/docs/freetrade_agreement.pdf'>《互选广告协议》</a></span>
                            <input id='freetrade_accept_cb' type="checkbox" class="label__checkbox" />
                        </label>
                    </div>
                </div>
            </div>
        </script>
        <script type="text/javascript">window._points[2]=+new Date;// dom加载完成</script>
        <script type="text/javascript" src="//res.wx.qq.com/promotion/res/zh_CN/htmledition/js/sea.js"></script>
        <script type="text/javascript" src="//res.wx.qq.com/promotion/res/zh_CN/htmledition/js/common/lib.js"></script>
        <script src="Content/js/mpres/htmledition/host_report.js"></script>
        <script type="text/javascript">
           
                t = r({
                    container: "#dateRange",
                    startDate: q().add("days", -7).format("YYYY-MM-DD"),
                    endDate: q().add("days", -1).format("YYYY-MM-DD"),
                    theme: "ta", isTodayValid: !0,
                    success: function (a) {
                        $(".jsDay").removeClass("selected"), j()
                    }
                })
            
</script>
        <script>
//seajs.use('ad_system/host_report');

        </script>



        <!-- FAQ 模版 -->
        <script type="text/html" id="js_faqscene_tpl">
            <div class="faqscene" id="js_faqscene_p">
                <div class="faqscene_inner">
                    <div class="faqscene_name js_faq_trigger">常见问题</div>
                    <div class="faqscene_panel js_faq_main_panel">
                        <a href="###" class="faqscene_close">x</a>
                        <div class="faqscene_hd">{data.question}</div>
                        <div class="faqscene_bd">
                            <div class="faqscene_tabs">
                                <div class="faqscene_tab_hd">
                                    <ul class="js_faq_class1">
                                        {if data.guide_list.length>2}
                                        {each data.guide_list as guide i}
                                        {if guide}
                                        <li data-report-id="{guide.report_id}"><a {if i= =0}class ="active" {/if} href="javascript:;">{guide.itemname}</a></li>
                                        {/if}

                                        {/each}
                                        {/if}
                                    </ul>
                                </div>
                                {if data.guide_list.length>1}
                                {/if}
                                {each data.guide_list as guide i}
                                {if guide}
                                <div class="faqscene_tab_bd js_faqscene_content">
                                    <ul>
                                        {each guide.subitems as subitem i}
                                        {if subitem}
                                        <li><a target="_blank" href="{subitem.kf_url}">{subitem.title}</a></li>
                                        {/if}
                                        {/each}
                                    </ul>
                                </div>
                                {/if}
                                {/each}
                            </div>
                        </div>
                        <div class="faqscene_ft"><a href="{data.more_help.kf_url}" target="_blank">{data.more_help.title}</a></div>
                    </div>
                </div>
            </div>
        </script>
        <!--FAQ 逻辑-->
        <script type="text/javascript">


;;;(function() {

var jq = jQuery;
var dom = null;
var panel = null;
var close = null
var faqArea = null;
var timer = null;
var tab_heads = null;
var tab_contents = null;
var token = urlParams.token
var report_id = null;

/**
 * 加载FAQ数据以及进行初始化
 */
function loadDataAndInit() {
    var param = "&cginame=" + urlParser.parser.pathname.replace(/^\//, '');
    var tValue = urlParser.getParam("t");
    var actionValue = urlParser.getParam("action");
    var pluginid = urlParser.getParam('pluginid'); // 带pluginid

    //https://mp.weixin.qq.com/misc/faq?action=getfaq&lang=zh_CN&f=json&cginame=merchant/ad_host_index&token=1168284857&t=ad_system/host_index

    //https://mp.weixin.qq.com/misc/faq?action=getfaq&lang=zh_CN&f=json&cginame=cgi-bin/frame&token=1168284857&t=ad_system/common_frame
    var getFAQUrl = "//mp.weixin.qq.com/misc/faq?action=getfaq&lang=zh_CN&f=json&cginame=merchant/ad_host_index&t=ad_system/host_index&token=" + token;

    $.ajax({
        type: "GET",
        url: getFAQUrl
    }).success(function(data) {
        if (data.base_resp.ret !== 0) return;
        wx.faq_list = data.base_resp.assistant.problem;
        if (!wx.faq_list.question) return; // 做保护，防止没有吐出
        renderFaq();
        makeActions();
        initReport();
        panel.hide();
        goto(0);
    }).error(function(error) {
        ; // ignore
    });
}

function renderFaq() {
    top.$("body").append(template.render("js_faqscene_tpl", {data: wx.faq_list}));
    dom = top.$("#js_faqscene_p");
    panel = dom.find(".js_faq_main_panel");
    close = dom.find(".faqscene_close");
    faqArea = dom.find(".faqscene_inner");
    timer = null;
    tab_heads = dom.find(".js_faq_class1 li");
    tab_contents = dom.find(".js_faqscene_content");
}

/**
 * 点击某个字分类显示该子分类的问题列表
 *
 * @param {Number} idx - 该子分类的下标
 */
function goto(idx) {
    var $currentTab = tab_heads.eq(idx);
    tab_contents.hide();
    subitem = $currentTab.find("a").text();
    report_id = (idx === 0)
              ? wx.faq_list.guide_list[0].report_id
              : $currentTab.data("report-id");
    jq(tab_contents[idx]).show();
    tab_heads.find("a").removeClass("active");
    jq(tab_heads[idx]).find("a").addClass("active");
}

function makeActions() {
    tab_heads.click(function() {
        var idx = jq(this).index();
        goto(idx);
    });

    // 点击x隐藏FAQ
    close.on("click", function(event) {
        event.preventDefault();
        clearTimeout(timer);
        panel.hide();
    });

    // 鼠标移出FAQ隐藏
    faqArea.on("mouseover", function() {
        clearTimeout(timer);
        panel.show();
    });

    faqArea.on("mouseout", function(event) {
        timer = setTimeout(function() {
            panel.hide();
        }, 300);
    });
}

/*======================== 用户点击，上报数据统计 =======================*/
var subitem = null;
var questText = "none";
var questLink = "none";
var urlParser = new URLParser(window.location.href);

function initReport() {
    subitem = wx.faq_list.guide_list[0].itemname;
    report_id = wx.faq_list.guide_list[0].report_id;
    // 上报每个独立的问题
    jq("div.js_faqscene_content").find("a").click(function(event) {
        var $question = jq(this);
        questText = $question.text();
        questLink = $question.attr("href");
        var reportData = getReportData();
        report(reportData);
    });
    // 上报更多问题链接的点击
    jq("div.faqscene_ft a").click(function(event) {
        var $more = jq(this);
        questText = $more.text();
        var reportData = getReportData();
        reportData.report_id = wx.faq_list.help_report_id;
        report(reportData);
    });
}

/**
 * ajax上报点击统计数据
 *
 * @param {Object} data - 统计数据
 */
function report(data) {
    //console.log(data);
    var reportUrl = "/misc/faq?action=report"
    $.ajax({
        url: reportUrl,
        data: data,
        type: "POST"
    }).success(function(data) {
        //console.log(data);
    });
}

/**
 * 获取需要上报的数据
 *
 * @return {Object} 需要上报的数据
 */
function getReportData() {
    var data = {};
    data.report_id = report_id;
    data.question = questText;
    data.action = "report";

    return data;
}


/**
 * URL分析器
 *
 * @param {String} url - 需要传入的URL
 * @constructor
 */
function URLParser(url) {
    // Check out this gist for URL parser hack:
    // https://gist.github.com/jlong/2428561
    var $el = jq("<a></a>").attr("href", url);
    this.el = $el.get(0);
    this.parser = this.el;
}

/**
 * 获取URL中的请求特定的请求参数
 *
 * @param {String} key - 需要查询的参数的键
 * @return {String|Null} - 返回值，不存在则为null
 */
URLParser.prototype.getParam = function(key) {
    var KEY_REG = new RegExp("([\?&])" + key + "=([^&#]*)([&#])?");
    var result = this.el.search.match(KEY_REG);
    return result
           ? result[2]
           : null;
};


loadDataAndInit();
})();
        </script>
        <script type="text/javascript">window._points[3]=+new Date;// js加载完成</script>
    </div>
</body>
</html>